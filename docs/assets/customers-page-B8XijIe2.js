import{r as c,j as e}from"./index-Dj3cS6za.js";import{A as g,a as N,b as f}from"./avatar-OeQvn9_O.js";import{B as n}from"./badge-DWVlFQai.js";import{B as u}from"./button-Crtod_yx.js";import{C as I,b as H,c as K,d as B,a as U}from"./card-C8qa4OaK.js";import{D as E,b as P,c as Q,d as V,e as $}from"./dialog-Bn5CZ0A2.js";import{I as O}from"./input-CZim18_A.js";import{T as R,a as q,b as d,c as i,d as M,e as t}from"./table-Bh6-j-BX.js";import{T as z,a as F,b as v,c as y}from"./tabs-CpJS4XpB.js";import{u as C}from"./useQuery-Q6h1jA1k.js";import{S as G}from"./search-BHHTIAnE.js";import{U as J,C as W}from"./user-plus-ChC4Qw98.js";import{L as b}from"./loader-circle-Bl7EfNa1.js";import{M as X,P as Y}from"./phone-B1stYZ6H.js";import{C as Z}from"./calendar-B3ImGPjP.js";import{U as _}from"./user-round-CaECQNfG.js";import"./Combination-27LuzUOQ.js";import"./index-Cq9-3w0A.js";function fe(){const[l,w]=c.useState(""),[a,T]=c.useState(null),[D,h]=c.useState(!1),{data:L=[],isLoading:S}=C({queryKey:["/api/users/customers"]}),{data:m=[],isLoading:k}=C({queryKey:["/api/users",a==null?void 0:a.id,"appointments"],enabled:!!a}),r=L.filter(s=>{var j,p;return`${s.firstName} ${s.lastName}`.toLowerCase().includes(l.toLowerCase())||(((j=s.email)==null?void 0:j.toLowerCase())||"").includes(l.toLowerCase())||(((p=s.phone)==null?void 0:p.toLowerCase())||"").includes(l.toLowerCase())}),A=s=>{T(s),h(!0)},x=(s,o)=>`${s.charAt(0)}${o.charAt(0)}`.toUpperCase();return e.jsxs("div",{children:[e.jsx("div",{className:"mb-6 flex items-center justify-between",children:e.jsxs("div",{children:[e.jsx("h2",{className:"font-heading text-2xl font-bold text-neutral-900",children:"Khách hàng"}),e.jsx("p",{className:"text-neutral-600",children:"Quản lý thông tin khách hàng của salon"})]})}),e.jsxs("div",{className:"mb-6 flex flex-col gap-4 md:flex-row",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx(G,{className:"absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 transform text-gray-400"}),e.jsx(O,{placeholder:"Tìm kiếm theo tên, email, hoặc số điện thoại...",className:"pl-9",value:l,onChange:s=>w(s.target.value)})]}),e.jsxs(u,{className:"md:w-auto",children:[e.jsx(J,{className:"mr-2 h-4 w-4"}),"Thêm khách hàng"]})]}),e.jsxs(I,{children:[e.jsxs(H,{className:"pb-3",children:[e.jsx(K,{children:"Danh sách khách hàng"}),e.jsxs(B,{children:["Tổng cộng: ",r.length," khách hàng"]})]}),e.jsx(U,{children:S?e.jsx("div",{className:"flex h-64 items-center justify-center",children:e.jsx(b,{className:"h-8 w-8 animate-spin text-primary"})}):e.jsx("div",{className:"rounded-md border",children:e.jsxs(R,{children:[e.jsx(q,{children:e.jsxs(d,{children:[e.jsx(i,{children:"Khách hàng"}),e.jsx(i,{children:"Email"}),e.jsx(i,{children:"Số điện thoại"}),e.jsx(i,{children:"Tình trạng"}),e.jsx(i,{className:"text-right",children:"Thao tác"})]})}),e.jsx(M,{children:r.length>0?r.map(s=>e.jsxs(d,{children:[e.jsx(t,{children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsxs(g,{children:[e.jsx(N,{src:s.profileImage||void 0}),e.jsx(f,{children:x(s.firstName,s.lastName)})]}),e.jsx("div",{children:e.jsxs("p",{className:"font-medium",children:[s.firstName," ",s.lastName]})})]})}),e.jsx(t,{children:s.email}),e.jsx(t,{children:s.phone||"-"}),e.jsx(t,{children:e.jsx(n,{variant:s.verified?"default":"secondary",children:s.verified?"Đã xác thực":"Chưa xác thực"})}),e.jsx(t,{className:"text-right",children:e.jsx(u,{variant:"ghost",size:"sm",onClick:()=>A(s),children:"Chi tiết"})})]},s.id)):e.jsx(d,{children:e.jsx(t,{colSpan:5,className:"py-8 text-center text-gray-500",children:"Không tìm thấy khách hàng nào"})})})]})})})]}),a&&e.jsx(E,{open:D,onOpenChange:h,children:e.jsxs(P,{className:"sm:max-w-[600px]",children:[e.jsxs(Q,{children:[e.jsx(V,{children:"Thông tin khách hàng"}),e.jsx($,{children:"Chi tiết thông tin và lịch sử sử dụng dịch vụ"})]}),e.jsxs("div",{className:"mb-4 flex flex-col items-start gap-4 md:flex-row md:items-center",children:[e.jsxs(g,{className:"h-16 w-16",children:[e.jsx(N,{src:a.profileImage||void 0}),e.jsx(f,{className:"text-xl",children:x(a.firstName,a.lastName)})]}),e.jsxs("div",{children:[e.jsxs("h3",{className:"text-xl font-bold",children:[a.firstName," ",a.lastName]}),e.jsxs("div",{className:"mt-1 flex flex-col space-y-1",children:[e.jsxs("div",{className:"flex items-center text-sm text-gray-500",children:[e.jsx(X,{className:"mr-2 h-4 w-4"}),a.email]}),a.phone&&e.jsxs("div",{className:"flex items-center text-sm text-gray-500",children:[e.jsx(Y,{className:"mr-2 h-4 w-4"}),a.phone]})]})]})]}),e.jsxs(z,{defaultValue:"appointments",children:[e.jsxs(F,{className:"grid w-full grid-cols-2",children:[e.jsx(v,{value:"appointments",children:"Lịch sử lịch hẹn"}),e.jsx(v,{value:"details",children:"Thông tin chi tiết"})]}),e.jsx(y,{value:"appointments",className:"py-2",children:k?e.jsx("div",{className:"flex h-48 items-center justify-center",children:e.jsx(b,{className:"h-6 w-6 animate-spin text-primary"})}):m.length>0?e.jsx("div",{className:"space-y-3",children:m.map(s=>e.jsxs("div",{className:"flex items-center justify-between rounded-md border p-3",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(Z,{className:"mr-2 h-4 w-4 text-primary"}),e.jsx("span",{className:"font-medium",children:new Date(s.date).toLocaleDateString("vi-VN")}),e.jsxs("span",{className:"ml-1 text-sm text-gray-500",children:["(",new Date(s.date).toLocaleTimeString("vi-VN",{hour:"2-digit",minute:"2-digit"}),")"]})]}),e.jsxs("div",{className:"mt-1 text-sm text-gray-500",children:["Dịch vụ: ",s.serviceId]})]}),e.jsx(n,{variant:s.status==="completed"?"default":s.status==="confirmed"?"success":s.status==="cancelled"?"destructive":"outline",children:s.status==="completed"?"Hoàn thành":s.status==="confirmed"?"Đã xác nhận":s.status==="cancelled"?"Đã hủy":"Chưa xác nhận"})]},s.id))}):e.jsxs("div",{className:"py-8 text-center text-gray-500",children:[e.jsx(W,{className:"mx-auto mb-2 h-10 w-10 text-gray-300"}),e.jsx("p",{children:"Khách hàng chưa có lịch sử đặt lịch"})]})}),e.jsx(y,{value:"details",className:"py-2",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500",children:"Họ"}),e.jsx("p",{className:"font-medium",children:a.firstName})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500",children:"Tên"}),e.jsx("p",{className:"font-medium",children:a.lastName})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500",children:"Email"}),e.jsx("p",{className:"font-medium",children:a.email})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500",children:"Số điện thoại"}),e.jsx("p",{className:"font-medium",children:a.phone||"Chưa cung cấp"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500",children:"Ngày tạo tài khoản"}),e.jsx("p",{className:"font-medium",children:a.createdAt&&new Date(a.createdAt).toLocaleDateString("vi-VN")})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500",children:"Trạng thái xác thực"}),e.jsx(n,{variant:a.verified?"default":"secondary",className:"mt-1",children:a.verified?"Đã xác thực":"Chưa xác thực"})]})]}),e.jsxs("div",{className:"mt-4 rounded-md border p-4",children:[e.jsxs("div",{className:"mb-2 flex items-center",children:[e.jsx(_,{className:"mr-2 h-4 w-4 text-primary"}),e.jsx("h4",{className:"font-medium",children:"Sở thích và lưu ý"})]}),e.jsx("p",{className:"text-sm text-gray-500",children:"Chưa có thông tin sở thích"})]})]})})]})]})})]})}export{fe as default};
